<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Defend the Fort - Trading Card Game</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js"></script>
</head>
<body>
    <!-- Animated background particles/smoke -->
    <div class="background-particles">
        <div class="particle particle-1"></div>
        <div class="particle particle-2"></div>
        <div class="particle particle-3"></div>
        <div class="particle particle-4"></div>
        <div class="particle particle-5"></div>
        <div class="particle particle-6"></div>
    </div>
    
    <!-- Main Menu -->
    <div class="main-menu" id="mainMenu">
        <div class="main-menu-content">
            <h1 class="main-menu-title">üõ°Ô∏è DEFEND THE FORT</h1>
            <div class="player-level-display" id="playerLevelDisplay" style="display: none;">
                <div class="level-info">
                    <span class="level-label">Level</span>
                    <span class="level-value" id="levelValue">1</span>
                </div>
                <div class="exp-bar-container">
                    <div class="exp-bar" id="expBar">
                        <div class="exp-fill" id="expFill" style="width: 0%;"></div>
                    </div>
                    <div class="exp-text" id="expText">0 / 100 XP</div>
                </div>
            </div>
            <div class="main-menu-buttons">
                <button class="btn btn-primary main-menu-btn" id="deckStudioMenuBtn">
                    <span class="btn-icon">üÉè</span>
                    <span class="btn-text">Deck Studio</span>
                </button>
                <button class="btn btn-primary main-menu-btn" id="playGameMenuBtn">
                    <span class="btn-icon">‚öîÔ∏è</span>
                    <span class="btn-text">Play Game</span>
                </button>
                <button class="btn btn-primary main-menu-btn" id="shopMenuBtn">
                    <span class="btn-icon">üõí</span>
                    <span class="btn-text">Shop</span>
                </button>
                <button class="btn btn-primary main-menu-btn" id="settingsMenuBtn">
                    <span class="btn-icon">‚öôÔ∏è</span>
                    <span class="btn-text">Settings</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Daily Login Reward Modal -->
    <div class="daily-login-modal" id="dailyLoginModal" style="display: none;">
        <div class="daily-login-content">
            <div class="daily-login-header">
                <h2>üéÅ Daily Login Reward!</h2>
                <button class="daily-login-close" id="dailyLoginClose">&times;</button>
            </div>
            <div class="daily-login-body">
                <div class="daily-login-streak" id="dailyLoginStreak">
                    <span class="streak-label">Login Streak:</span>
                    <span class="streak-value" id="streakValue">1</span> days
                </div>
                <div class="daily-login-reward" id="dailyLoginReward">
                    <!-- Reward content will be inserted here -->
                </div>
            </div>
            <div class="daily-login-footer">
                <button class="btn btn-primary" id="dailyLoginClaim">Claim Reward</button>
            </div>
        </div>
    </div>

    <!-- Game container removed - battle is now on battle.html -->
    <div class="game-container" id="gameContainer" style="display: none;">
        <header class="game-header">
            <div class="game-info">
                <div class="turn-indicator" id="turnIndicator">Player 1's Turn</div>
                <div class="turn-counter">Turn: <span id="turnNumber">1</span></div>
                <div class="currency-display">
                    <div class="currency-item">
                        <span class="currency-icon">ü™ô</span>
                        <span class="currency-value" id="goldDisplay">0</span>
                    </div>
                    <div class="currency-item">
                        <span class="currency-icon">‚ú®</span>
                        <span class="currency-value" id="arcanaDisplay">0</span>
                    </div>
                </div>
                <button class="settings-btn" id="deckStudioBtn" title="Deck Studio">üÉè</button>
                <button class="settings-btn" id="settingsBtn" title="Settings">‚öôÔ∏è</button>
            </div>
        </header>

        <!-- Opponent Area -->
        <div class="player-area opponent-area">
            <div class="character-icon" id="player2CharacterIcon">
                <img src="" alt="Player 2" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                <div class="character-icon-placeholder" style="display: none;">üë§</div>
            </div>
            <div class="player-header">
                <div class="player-info">
                    <div class="player-name">Player 2</div>
                </div>
                <div class="player-stats">
                    <div class="stat">
                        <span class="stat-label">‚≠ê Stars:</span>
                        <span class="stat-value" id="player2Stars">2</span>
                    </div>
                    <div class="stat">
                        <span class="stat-label">üè∞ Fort HP:</span>
                        <span class="stat-value fort-hp" id="player2FortHP" data-player="player2">50</span>
                    </div>
                </div>
            </div>
            <div class="spell-trap-row">
                <div class="spell-trap-zone" id="player2SpellTrapZone">
                    <div class="zone-label">Spell/Trap Zone</div>
                </div>
                <div class="graveyard opponent-graveyard" id="player2Graveyard">
                    <div class="zone-label">Graveyard</div>
                </div>
            </div>
            <div class="monster-field" id="player2MonsterField">
                <div class="zone-label" id="player2MonsterFieldLabel">Monster Field</div>
                <div class="monster-slots"></div>
            </div>
        </div>

        <!-- Game Board Center -->
        <div class="game-center">
            <button class="battle-log-toggle" id="battleLogToggle">üìú Battle Log</button>
            <div class="battle-zone" id="battleZone" style="display: none;">
                <div class="battle-log" id="battleLog">
                    <div class="log-header">Battle Log</div>
                    <div class="log-content" id="logContent"></div>
                </div>
            </div>
        </div>

        <!-- Player Area -->
        <div class="player-area player-area">
            <div class="monster-field" id="player1MonsterField">
                <div class="zone-label" id="player1MonsterFieldLabel">Monster Field</div>
                <div class="monster-slots"></div>
            </div>
            <div class="spell-trap-row">
                <div class="spell-trap-zone" id="player1SpellTrapZone">
                    <div class="zone-label">Spell/Trap Zone</div>
                </div>
                <div class="graveyard player-graveyard" id="player1Graveyard">
                    <div class="zone-label">Graveyard</div>
                </div>
            </div>
            <div class="character-icon" id="player1CharacterIcon">
                <img src="" alt="Player 1" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                <div class="character-icon-placeholder" style="display: none;">üë§</div>
            </div>
            <div class="player-header">
                <div class="player-info">
                    <div class="player-name">Player 1</div>
                </div>
                <div class="player-stats">
                    <div class="stat">
                        <span class="stat-label">‚≠ê Stars:</span>
                        <span class="stat-value" id="player1Stars">2</span>
                    </div>
                    <div class="stat">
                        <span class="stat-label">üè∞ Fort HP:</span>
                        <span class="stat-value fort-hp" id="player1FortHP" data-player="player1">50</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Hand and Actions -->
        <div class="bottom-panel">
            <div class="hand-container">
                <div class="hand-label">Your Hand</div>
                <div class="hand" id="playerHand"></div>
            </div>
            <div class="action-panel">
                <button class="btn btn-primary" id="endTurnBtn">End Turn</button>
                <button class="btn btn-secondary" id="upgradeFortBtn">Upgrade Fort (5‚≠ê)</button>
                <div class="upgrade-options" id="upgradeOptions"></div>
            </div>
        </div>

        <!-- Settings Modal -->
        <div class="modal" id="settingsModal">
            <div class="modal-content settings-modal">
                <span class="close" id="closeSettings">&times;</span>
                <button class="btn btn-secondary" id="backToMainMenuBtn" style="margin-bottom: 15px; width: 100%;">‚Üê Back to Main Menu</button>
                <h2>‚öôÔ∏è Settings</h2>
                <div class="settings-section">
                    <h3>üéµ Music Controls</h3>
                    <div class="music-controls" id="musicControls">
                        <div class="music-info">
                            <span id="currentTrackName">Game Music 1</span>
                        </div>
                        <div class="music-buttons">
                            <button class="music-btn" id="musicPrev">‚èÆÔ∏è</button>
                            <button class="music-btn" id="musicPlayPause">‚ñ∂Ô∏è</button>
                            <button class="music-btn" id="musicNext">‚è≠Ô∏è</button>
                        </div>
                        <div class="music-volume-control">
                            <span>üîä</span>
                            <input type="range" id="musicVolume" min="0" max="100" value="50" class="volume-slider">
                        </div>
                        <select id="musicTrackSelect" class="music-select">
                            <option value="0">Game Music 1</option>
                            <option value="1">Battle Music</option>
                            <option value="2">Boss Battle</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal for Card Details -->
        <div class="modal" id="cardModal">
            <div class="modal-content">
                <span class="close" id="closeModal">&times;</span>
                <div id="modalCardDetails"></div>
            </div>
        </div>

        <!-- Deck Studio Modal -->
        <div class="modal" id="deckStudioModal">
            <div class="modal-content deck-studio-modal">
                <span class="close" id="closeDeckStudio">&times;</span>
                <h2>üÉè Deck Studio</h2>
                <div class="deck-studio-container">
                    <div class="deck-studio-sidebar">
                        <div class="deck-stats" id="deckStats">
                            <h3>Deck Statistics</h3>
                            <div class="stat-item">
                                <span>Total Cards:</span>
                                <span id="statTotal">0</span>
                            </div>
                            <div class="stat-item">
                                <span>Monsters:</span>
                                <span id="statMonsters">0</span>
                            </div>
                            <div class="stat-item">
                                <span>Spells:</span>
                                <span id="statSpells">0</span>
                            </div>
                            <div class="stat-item">
                                <span>Traps:</span>
                                <span id="statTraps">0</span>
                            </div>
                        </div>
                        <div class="deck-actions">
                            <button class="btn btn-primary" id="saveDeckBtn">Save Deck</button>
                            <button class="btn btn-secondary" id="resetDeckBtn">Reset to Default</button>
                            <button class="btn btn-secondary" id="exportDeckBtn">Export Deck</button>
                            <button class="btn btn-secondary" id="importDeckBtn">Import Deck</button>
                        </div>
                    </div>
                    <div class="deck-studio-main">
                        <div class="card-browser">
                            <div class="card-filter">
                                <button class="filter-btn active" data-filter="all">All Cards</button>
                                <button class="filter-btn" data-filter="monster">Monsters</button>
                                <button class="filter-btn" data-filter="spell">Spells</button>
                                <button class="filter-btn" data-filter="trap">Traps</button>
                            </div>
                            <div class="card-list" id="cardBrowser"></div>
                        </div>
                        <div class="current-deck">
                            <h3>Your Deck</h3>
                            <div class="deck-list" id="currentDeck"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Win Modal -->
        <div class="modal" id="winModal">
            <div class="modal-content win-modal">
                <h2 id="winTitle">Victory!</h2>
                <p id="winMessage"></p>
                <button class="btn btn-primary" id="newGameBtn">New Game</button>
            </div>
        </div>

        <!-- Battle Start Intro Screen -->
        <div class="modal battle-intro-modal" id="battleIntroModal">
            <div class="battle-intro-content">
                <div class="battle-intro-title">DEFEND THE FORT</div>
                <div class="battle-intro-subtitle">Reduce your enemy's Fort HP to zero!</div>
                <div class="battle-intro-narrator" id="battleIntroNarrator"></div>
                <div class="battle-intro-commence">COMMENCE!</div>
            </div>
            <!-- Voice audio for intro -->
            <audio id="introVoiceAudio" preload="auto">
                <source src="assets/voice/letitcommence.mp3" type="audio/mpeg">
            </audio>
        </div>
    </div>


    <!-- Firebase Configuration and Setup -->
    <script src="js/firebase-config.js"></script>
    <script src="js/firebase-init.js"></script>
    <script src="js/firebase-save.js"></script>
    
    <script src="js/menu.js"></script>
    <script src="js/music.js"></script>
    <script src="js/game.js"></script>
    <script src="js/cards.js"></script>
    <script src="js/deck.js"></script>
    <script src="js/player-level.js"></script>
    <script src="js/daily-login.js"></script>
    <script src="js/monster.js"></script>
    <script src="js/player.js"></script>
    <script src="js/spell.js"></script>
    <script src="js/trap.js"></script>
    <script src="js/ai.js"></script>
    <script src="js/main.js"></script>
    <script src="js/deckStudio.js"></script>
    
    <!-- Initialize Firebase on page load -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                if (typeof initializeFirebase === 'function') {
                    initializeFirebase();
                }
            }, 500);
        });
    </script>
</body>
</html>

